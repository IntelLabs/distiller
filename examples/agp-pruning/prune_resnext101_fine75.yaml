# python3 ${DISTILLER_PATH}/examples/classifier_compression/compress_classifier.py --arch=resnext101_32x4d --pretrained --compress=${THIS} --epochs=81 --lr 0.01 ${IMAGENET_PATH} --vs=0

# Parameters:
# +-----+-------------------------------------+--------------------+---------------+----------------+------------+------------+----------+----------+----------+------------+---------+----------+------------+
# |     | Name                                | Shape              |   NNZ (dense) |   NNZ (sparse) |   Cols (%) |   Rows (%) |   Ch (%) |   2D (%) |   3D (%) |   Fine (%) |     Std |     Mean |   Abs-Mean |
# |-----+-------------------------------------+--------------------+---------------+----------------+------------+------------+----------+----------+----------+------------+---------+----------+------------|
# |   0 | module.features.4.0.0.0.0.0.weight  | (128, 64, 1, 1)    |          8192 |           2048 |    0.00000 |    0.00000 | 20.31250 | 75.00000 | 37.50000 |   75.00000 | 0.04950 | -0.00209 |    0.01767 |
# |   1 | module.features.4.0.0.0.0.3.weight  | (128, 4, 3, 3)     |          4608 |           1152 |    0.00000 |    0.00000 |  0.00000 | 45.31250 |  7.03125 |   75.00000 | 0.06919 |  0.00106 |    0.02635 |
# |   2 | module.features.4.0.0.0.1.weight    | (256, 128, 1, 1)   |         32768 |           8192 |    0.00000 |    0.00000 |  7.03125 | 75.00000 | 24.21875 |   75.00000 | 0.02982 | -0.00001 |    0.01192 |
# |   3 | module.features.4.0.0.1.0.weight    | (256, 64, 1, 1)    |         16384 |           4096 |    0.00000 |    0.00000 | 20.31250 | 75.00000 | 24.21875 |   75.00000 | 0.04257 | -0.00187 |    0.01620 |
# |   4 | module.features.4.1.0.0.0.0.weight  | (128, 256, 1, 1)   |         32768 |           8192 |    0.00000 |    0.00000 | 24.21875 | 75.00000 | 22.65625 |   75.00000 | 0.02325 |  0.00042 |    0.00951 |
# |   5 | module.features.4.1.0.0.0.3.weight  | (128, 4, 3, 3)     |          4608 |           1152 |    0.00000 |    0.00000 |  0.00000 | 29.68750 | 13.28125 |   75.00000 | 0.05387 | -0.00036 |    0.02368 |
# |   6 | module.features.4.1.0.0.1.weight    | (256, 128, 1, 1)   |         32768 |           8192 |    0.00000 |    0.00000 | 13.28125 | 75.00000 |  1.17188 |   75.00000 | 0.02598 | -0.00124 |    0.01091 |
# |   7 | module.features.4.2.0.0.0.0.weight  | (128, 256, 1, 1)   |         32768 |           8192 |    0.00000 |    0.00000 |  1.56250 | 75.00000 | 12.50000 |   75.00000 | 0.02288 | -0.00030 |    0.00968 |
# |   8 | module.features.4.2.0.0.0.3.weight  | (128, 4, 3, 3)     |          4608 |           1152 |    0.00000 |    0.00000 |  0.00000 | 26.95312 |  5.46875 |   75.00000 | 0.05101 | -0.00082 |    0.02403 |
# |   9 | module.features.4.2.0.0.1.weight    | (256, 128, 1, 1)   |         32768 |           8192 |    0.00000 |    0.00000 |  5.46875 | 75.00000 |  0.00000 |   75.00000 | 0.02409 | -0.00113 |    0.00999 |
# |  10 | module.features.5.0.0.0.0.0.weight  | (256, 256, 1, 1)   |         65536 |          16384 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  0.39062 |   75.00000 | 0.02742 | -0.00134 |    0.01177 |
# |  11 | module.features.5.0.0.0.0.3.weight  | (256, 8, 3, 3)     |         18432 |           4608 |    0.00000 |    0.00000 |  0.00000 | 44.14062 |  0.39062 |   75.00000 | 0.03603 |  0.00066 |    0.01609 |
# |  12 | module.features.5.0.0.0.1.weight    | (512, 256, 1, 1)   |        131072 |          32768 |    0.00000 |    0.00000 |  0.39062 | 75.00000 |  3.90625 |   75.00000 | 0.02202 | -0.00001 |    0.00890 |
# |  13 | module.features.5.0.0.1.0.weight    | (512, 256, 1, 1)   |        131072 |          32768 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  3.90625 |   75.00000 | 0.01690 | -0.00022 |    0.00639 |
# |  14 | module.features.5.1.0.0.0.0.weight  | (256, 512, 1, 1)   |        131072 |          32768 |    0.00000 |    0.00000 |  3.90625 | 75.00000 |  7.03125 |   75.00000 | 0.01444 |  0.00009 |    0.00556 |
# |  15 | module.features.5.1.0.0.0.3.weight  | (256, 8, 3, 3)     |         18432 |           4608 |    0.00000 |    0.00000 |  0.00000 | 28.41797 |  4.68750 |   75.00000 | 0.03772 | -0.00185 |    0.01647 |
# |  16 | module.features.5.1.0.0.1.weight    | (512, 256, 1, 1)   |        131072 |          32768 |    0.00000 |    0.00000 |  4.68750 | 75.00000 |  0.19531 |   75.00000 | 0.01766 | -0.00086 |    0.00707 |
# |  17 | module.features.5.2.0.0.0.0.weight  | (256, 512, 1, 1)   |        131072 |          32768 |    0.00000 |    0.00000 |  0.19531 | 75.00000 |  1.95312 |   75.00000 | 0.01684 | -0.00026 |    0.00676 |
# |  18 | module.features.5.2.0.0.0.3.weight  | (256, 8, 3, 3)     |         18432 |           4608 |    0.00000 |    0.00000 |  0.00000 | 21.24023 |  3.12500 |   75.00000 | 0.03421 | -0.00245 |    0.01566 |
# |  19 | module.features.5.2.0.0.1.weight    | (512, 256, 1, 1)   |        131072 |          32768 |    0.00000 |    0.00000 |  3.12500 | 75.00000 |  0.00000 |   75.00000 | 0.01759 | -0.00043 |    0.00718 |
# |  20 | module.features.5.3.0.0.0.0.weight  | (256, 512, 1, 1)   |        131072 |          32768 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  0.39062 |   75.00000 | 0.01606 | -0.00028 |    0.00659 |
# |  21 | module.features.5.3.0.0.0.3.weight  | (256, 8, 3, 3)     |         18432 |           4608 |    0.00000 |    0.00000 |  0.00000 | 22.94922 |  1.56250 |   75.00000 | 0.03268 | -0.00105 |    0.01497 |
# |  22 | module.features.5.3.0.0.1.weight    | (512, 256, 1, 1)   |        131072 |          32768 |    0.00000 |    0.00000 |  1.56250 | 75.00000 |  0.00000 |   75.00000 | 0.01581 | -0.00076 |    0.00643 |
# |  23 | module.features.6.0.0.0.0.0.weight  | (512, 512, 1, 1)   |        262144 |          65536 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  0.00000 |   75.00000 | 0.02107 | -0.00063 |    0.00889 |
# |  24 | module.features.6.0.0.0.0.3.weight  | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 43.65234 |  0.39062 |   75.00000 | 0.02407 |  0.00091 |    0.01040 |
# |  25 | module.features.6.0.0.0.1.weight    | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.39062 | 75.00000 |  2.44141 |   75.00000 | 0.01689 |  0.00015 |    0.00679 |
# |  26 | module.features.6.0.0.1.0.weight    | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  2.44141 |   75.00000 | 0.01092 | -0.00003 |    0.00425 |
# |  27 | module.features.6.1.0.0.0.0.weight  | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  2.44141 | 75.00000 |  1.75781 |   75.00000 | 0.00871 |  0.00007 |    0.00335 |
# |  28 | module.features.6.1.0.0.0.3.weight  | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 26.00098 |  3.32031 |   75.00000 | 0.01856 | -0.00134 |    0.00811 |
# |  29 | module.features.6.1.0.0.1.weight    | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  3.32031 | 75.00000 |  1.17188 |   75.00000 | 0.01123 | -0.00017 |    0.00451 |
# |  30 | module.features.6.2.0.0.0.0.weight  | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  1.17188 | 75.00000 |  1.17188 |   75.00000 | 0.00963 | -0.00005 |    0.00374 |
# |  31 | module.features.6.2.0.0.0.3.weight  | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 27.18506 |  2.92969 |   75.00000 | 0.01864 | -0.00134 |    0.00822 |
# |  32 | module.features.6.2.0.0.1.weight    | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  2.92969 | 75.00000 |  0.58594 |   75.00000 | 0.01137 | -0.00023 |    0.00456 |
# |  33 | module.features.6.3.0.0.0.0.weight  | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.58594 | 75.00000 |  0.58594 |   75.00000 | 0.00989 | -0.00005 |    0.00390 |
# |  34 | module.features.6.3.0.0.0.3.weight  | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 26.14746 |  0.97656 |   75.00000 | 0.01815 | -0.00100 |    0.00785 |
# |  35 | module.features.6.3.0.0.1.weight    | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.97656 | 75.00000 |  0.19531 |   75.00000 | 0.01110 | -0.00026 |    0.00451 |
# |  36 | module.features.6.4.0.0.0.0.weight  | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.19531 | 75.00000 |  0.58594 |   75.00000 | 0.00994 | -0.00002 |    0.00393 |
# |  37 | module.features.6.4.0.0.0.3.weight  | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 24.14551 |  0.58594 |   75.00000 | 0.01823 | -0.00098 |    0.00797 |
# |  38 | module.features.6.4.0.0.1.weight    | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.58594 | 75.00000 |  0.00000 |   75.00000 | 0.01055 | -0.00024 |    0.00424 |
# |  39 | module.features.6.5.0.0.0.0.weight  | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  3.51562 |   75.00000 | 0.01011 | -0.00012 |    0.00395 |
# |  40 | module.features.6.5.0.0.0.3.weight  | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 24.42627 |  2.73438 |   75.00000 | 0.01912 | -0.00141 |    0.00848 |
# |  41 | module.features.6.5.0.0.1.weight    | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  1.75781 | 75.00000 |  0.00000 |   75.00000 | 0.01062 | -0.00017 |    0.00422 |
# |  42 | module.features.6.6.0.0.0.0.weight  | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  5.07812 |   75.00000 | 0.00981 | -0.00002 |    0.00383 |
# |  43 | module.features.6.6.0.0.0.3.weight  | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 25.12207 |  0.58594 |   75.00000 | 0.01714 | -0.00060 |    0.00733 |
# |  44 | module.features.6.6.0.0.1.weight    | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.39062 | 75.00000 |  0.00000 |   75.00000 | 0.00993 | -0.00024 |    0.00400 |
# |  45 | module.features.6.7.0.0.0.0.weight  | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  6.05469 |   75.00000 | 0.01019 | -0.00006 |    0.00402 |
# |  46 | module.features.6.7.0.0.0.3.weight  | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 28.58887 |  0.58594 |   75.00000 | 0.01756 | -0.00066 |    0.00757 |
# |  47 | module.features.6.7.0.0.1.weight    | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.58594 | 75.00000 |  0.00000 |   75.00000 | 0.01019 | -0.00016 |    0.00408 |
# |  48 | module.features.6.8.0.0.0.0.weight  | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  4.49219 |   75.00000 | 0.01028 | -0.00003 |    0.00408 |
# |  49 | module.features.6.8.0.0.0.3.weight  | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 26.51367 |  2.14844 |   75.00000 | 0.01635 | -0.00046 |    0.00700 |
# |  50 | module.features.6.8.0.0.1.weight    | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  1.95312 | 75.00000 |  0.00000 |   75.00000 | 0.00986 | -0.00022 |    0.00401 |
# |  51 | module.features.6.9.0.0.0.0.weight  | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  7.42188 |   75.00000 | 0.01067 | -0.00015 |    0.00421 |
# |  52 | module.features.6.9.0.0.0.3.weight  | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 30.15137 |  3.32031 |   75.00000 | 0.01821 | -0.00114 |    0.00787 |
# |  53 | module.features.6.9.0.0.1.weight    | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  2.92969 | 75.00000 |  0.00000 |   75.00000 | 0.01022 | -0.00016 |    0.00404 |
# |  54 | module.features.6.10.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 | 10.74219 |   75.00000 | 0.01056 | -0.00005 |    0.00418 |
# |  55 | module.features.6.10.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 32.72705 |  4.29688 |   75.00000 | 0.01647 | -0.00023 |    0.00690 |
# |  56 | module.features.6.10.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  3.90625 | 75.00000 |  0.00000 |   75.00000 | 0.01025 | -0.00019 |    0.00415 |
# |  57 | module.features.6.11.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  7.42188 |   75.00000 | 0.01074 | -0.00014 |    0.00434 |
# |  58 | module.features.6.11.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 30.60303 |  3.12500 |   75.00000 | 0.01633 | -0.00022 |    0.00680 |
# |  59 | module.features.6.11.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  2.92969 | 75.00000 |  0.00000 |   75.00000 | 0.01042 | -0.00015 |    0.00428 |
# |  60 | module.features.6.12.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 | 11.13281 |   75.00000 | 0.01035 | -0.00019 |    0.00421 |
# |  61 | module.features.6.12.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 32.93457 |  3.90625 |   75.00000 | 0.01616 | -0.00022 |    0.00675 |
# |  62 | module.features.6.12.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  3.51562 | 75.00000 |  0.00000 |   75.00000 | 0.00983 | -0.00030 |    0.00398 |
# |  63 | module.features.6.13.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 | 15.82031 |   75.00000 | 0.01070 | -0.00017 |    0.00429 |
# |  64 | module.features.6.13.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 32.97119 |  3.51562 |   75.00000 | 0.01508 |  0.00029 |    0.00597 |
# |  65 | module.features.6.13.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  4.49219 | 75.00000 |  0.00000 |   75.00000 | 0.01021 | -0.00024 |    0.00421 |
# |  66 | module.features.6.14.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  9.37500 |   75.00000 | 0.01098 | -0.00023 |    0.00452 |
# |  67 | module.features.6.14.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 31.42090 |  1.17188 |   75.00000 | 0.01577 |  0.00007 |    0.00645 |
# |  68 | module.features.6.14.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  1.17188 | 75.00000 |  0.09766 |   75.00000 | 0.01044 | -0.00021 |    0.00429 |
# |  69 | module.features.6.15.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 | 11.71875 |   75.00000 | 0.01096 | -0.00029 |    0.00448 |
# |  70 | module.features.6.15.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 30.15137 |  1.95312 |   75.00000 | 0.01485 |  0.00065 |    0.00583 |
# |  71 | module.features.6.15.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  1.95312 | 75.00000 |  0.00000 |   75.00000 | 0.01047 | -0.00033 |    0.00434 |
# |  72 | module.features.6.16.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 | 15.03906 |   75.00000 | 0.01088 | -0.00038 |    0.00449 |
# |  73 | module.features.6.16.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 31.53076 |  6.83594 |   75.00000 | 0.01479 |  0.00048 |    0.00573 |
# |  74 | module.features.6.16.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  7.22656 | 75.00000 |  0.00000 |   75.00000 | 0.01031 | -0.00031 |    0.00424 |
# |  75 | module.features.6.17.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 | 23.24219 |   75.00000 | 0.01085 | -0.00038 |    0.00446 |
# |  76 | module.features.6.17.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 36.35254 | 10.74219 |   75.00000 | 0.01369 |  0.00066 |    0.00519 |
# |  77 | module.features.6.17.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 | 10.93750 | 75.00000 |  0.00000 |   75.00000 | 0.01011 | -0.00033 |    0.00416 |
# |  78 | module.features.6.18.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 | 15.42969 |   75.00000 | 0.01128 | -0.00039 |    0.00466 |
# |  79 | module.features.6.18.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 33.05664 |  5.27344 |   75.00000 | 0.01433 |  0.00082 |    0.00547 |
# |  80 | module.features.6.18.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  5.85938 | 75.00000 |  0.00000 |   75.00000 | 0.01045 | -0.00041 |    0.00432 |
# |  81 | module.features.6.19.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 | 21.28906 |   75.00000 | 0.01140 | -0.00043 |    0.00470 |
# |  82 | module.features.6.19.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 35.68115 |  8.20312 |   75.00000 | 0.01429 |  0.00091 |    0.00535 |
# |  83 | module.features.6.19.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  8.39844 | 75.00000 |  0.00000 |   75.00000 | 0.01037 | -0.00041 |    0.00427 |
# |  84 | module.features.6.20.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 | 23.43750 |   75.00000 | 0.01164 | -0.00043 |    0.00480 |
# |  85 | module.features.6.20.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 39.24561 | 12.89062 |   75.00000 | 0.01434 |  0.00042 |    0.00554 |
# |  86 | module.features.6.20.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 | 12.89062 | 75.00000 |  0.00000 |   75.00000 | 0.01052 | -0.00043 |    0.00427 |
# |  87 | module.features.6.21.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 | 18.16406 |   75.00000 | 0.01221 | -0.00050 |    0.00512 |
# |  88 | module.features.6.21.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 33.76465 |  6.64062 |   75.00000 | 0.01402 |  0.00097 |    0.00551 |
# |  89 | module.features.6.21.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  6.64062 | 75.00000 |  0.00000 |   75.00000 | 0.01103 | -0.00064 |    0.00460 |
# |  90 | module.features.6.22.0.0.0.0.weight | (512, 1024, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  0.00000 | 75.00000 | 11.13281 |   75.00000 | 0.01284 | -0.00064 |    0.00544 |
# |  91 | module.features.6.22.0.0.0.3.weight | (512, 16, 3, 3)    |         73728 |          18432 |    0.00000 |    0.00000 |  0.00000 | 31.54297 |  5.07812 |   75.00000 | 0.01419 |  0.00144 |    0.00556 |
# |  92 | module.features.6.22.0.0.1.weight   | (1024, 512, 1, 1)  |        524288 |         131072 |    0.00000 |    0.00000 |  5.27344 | 75.00000 |  0.00000 |   75.00000 | 0.01148 | -0.00060 |    0.00483 |
# |  93 | module.features.7.0.0.0.0.0.weight  | (1024, 1024, 1, 1) |       1048576 |         262144 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  1.26953 |   75.00000 | 0.01804 | -0.00074 |    0.00806 |
# |  94 | module.features.7.0.0.0.0.3.weight  | (1024, 32, 3, 3)   |        294912 |          73728 |    0.00000 |    0.00000 |  0.00000 | 15.52734 |  0.00000 |   75.00000 | 0.01455 |  0.00111 |    0.00491 |
# |  95 | module.features.7.0.0.0.1.weight    | (2048, 1024, 1, 1) |       2097152 |         524288 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  0.00000 |   75.00000 | 0.01343 | -0.00039 |    0.00587 |
# |  96 | module.features.7.0.0.1.0.weight    | (2048, 1024, 1, 1) |       2097152 |         524288 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  0.00000 |   75.00000 | 0.01104 | -0.00040 |    0.00471 |
# |  97 | module.features.7.1.0.0.0.0.weight  | (1024, 2048, 1, 1) |       2097152 |         524288 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  0.00000 |   75.00000 | 0.01442 | -0.00032 |    0.00639 |
# |  98 | module.features.7.1.0.0.0.3.weight  | (1024, 32, 3, 3)   |        294912 |          73728 |    0.00000 |    0.00000 |  0.00000 | 42.93213 |  0.00000 |   75.00000 | 0.01679 | -0.00037 |    0.00757 |
# |  99 | module.features.7.1.0.0.1.weight    | (2048, 1024, 1, 1) |       2097152 |         524288 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  0.00000 |   75.00000 | 0.01243 | -0.00005 |    0.00552 |
# | 100 | module.features.7.2.0.0.0.0.weight  | (1024, 2048, 1, 1) |       2097152 |         524288 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  0.00000 |   75.00000 | 0.01259 | -0.00025 |    0.00562 |
# | 101 | module.features.7.2.0.0.0.3.weight  | (1024, 32, 3, 3)   |        294912 |          73728 |    0.00000 |    0.00000 |  0.00000 | 43.87817 |  0.00000 |   75.00000 | 0.01273 | -0.00016 |    0.00489 |
# | 102 | module.features.7.2.0.0.1.weight    | (2048, 1024, 1, 1) |       2097152 |         524288 |    0.00000 |    0.00000 |  0.00000 | 75.00000 |  0.00000 |   75.00000 | 0.00975 |  0.00008 |    0.00432 |
# | 103 | module.last_linear.weight           | (1000, 2048)       |       2048000 |         512000 |    0.00000 |    0.00000 |  0.00000 |  0.00000 |  0.00000 |   75.00000 | 0.03002 |  0.00332 |    0.01307 |
# | 104 | Total sparsity:                     | -                  |      44038848 |       11016768 |    0.00000 |    0.00000 |  0.00000 |  0.00000 |  0.00000 |   74.98398 | 0.00000 |  0.00000 |    0.00000 |
# +-----+-------------------------------------+--------------------+---------------+----------------+------------+------------+----------+----------+----------+------------+---------+----------+------------+
# 2019-03-18 13:15:41,611 - Total sparsity: 75.0%

# 2019-03-18 13:16:45,432 - ==> Best Top1: 78.658 Top5: 94.264 on epoch: 80

version: 1

pruners:
  the_pruner:
    class: AutomatedGradualPruner
    initial_sparsity : 0.01
    final_sparsity: 0.75
    weights: [
        # resnext101 layers (barring the 1st)
        module.features.4.0.0.0.0.0.weight,
        module.features.4.0.0.0.0.3.weight,
        module.features.4.0.0.0.1.weight,
        module.features.4.0.0.1.0.weight,
        module.features.4.1.0.0.0.0.weight,
        module.features.4.1.0.0.0.3.weight,
        module.features.4.1.0.0.1.weight,
        module.features.4.2.0.0.0.0.weight,
        module.features.4.2.0.0.0.3.weight,
        module.features.4.2.0.0.1.weight,
        module.features.5.0.0.0.0.0.weight,
        module.features.5.0.0.0.0.3.weight,
        module.features.5.0.0.0.1.weight,
        module.features.5.0.0.1.0.weight,
        module.features.5.1.0.0.0.0.weight,
        module.features.5.1.0.0.0.3.weight,
        module.features.5.1.0.0.1.weight,
        module.features.5.2.0.0.0.0.weight,
        module.features.5.2.0.0.0.3.weight,
        module.features.5.2.0.0.1.weight,
        module.features.5.3.0.0.0.0.weight,
        module.features.5.3.0.0.0.3.weight,
        module.features.5.3.0.0.1.weight,
        module.features.6.0.0.0.0.0.weight,
        module.features.6.0.0.0.0.3.weight,
        module.features.6.0.0.0.1.weight,
        module.features.6.0.0.1.0.weight,
        module.features.6.1.0.0.0.0.weight,
        module.features.6.1.0.0.0.3.weight,
        module.features.6.1.0.0.1.weight,
        module.features.6.2.0.0.0.0.weight,
        module.features.6.2.0.0.0.3.weight,
        module.features.6.2.0.0.1.weight,
        module.features.6.3.0.0.0.0.weight,
        module.features.6.3.0.0.0.3.weight,
        module.features.6.3.0.0.1.weight,
        module.features.6.4.0.0.0.0.weight,
        module.features.6.4.0.0.0.3.weight,
        module.features.6.4.0.0.1.weight,
        module.features.6.5.0.0.0.0.weight,
        module.features.6.5.0.0.0.3.weight,
        module.features.6.5.0.0.1.weight,
        module.features.6.6.0.0.0.0.weight,
        module.features.6.6.0.0.0.3.weight,
        module.features.6.6.0.0.1.weight,
        module.features.6.7.0.0.0.0.weight,
        module.features.6.7.0.0.0.3.weight,
        module.features.6.7.0.0.1.weight,
        module.features.6.8.0.0.0.0.weight,
        module.features.6.8.0.0.0.3.weight,
        module.features.6.8.0.0.1.weight,
        module.features.6.9.0.0.0.0.weight,
        module.features.6.9.0.0.0.3.weight,
        module.features.6.9.0.0.1.weight,
        module.features.6.10.0.0.0.0.weight,
        module.features.6.10.0.0.0.3.weight,
        module.features.6.10.0.0.1.weight,
        module.features.6.11.0.0.0.0.weight,
        module.features.6.11.0.0.0.3.weight,
        module.features.6.11.0.0.1.weight,
        module.features.6.12.0.0.0.0.weight,
        module.features.6.12.0.0.0.3.weight,
        module.features.6.12.0.0.1.weight,
        module.features.6.13.0.0.0.0.weight,
        module.features.6.13.0.0.0.3.weight,
        module.features.6.13.0.0.1.weight,
        module.features.6.14.0.0.0.0.weight,
        module.features.6.14.0.0.0.3.weight,
        module.features.6.14.0.0.1.weight,
        module.features.6.15.0.0.0.0.weight,
        module.features.6.15.0.0.0.3.weight,
        module.features.6.15.0.0.1.weight,
        module.features.6.16.0.0.0.0.weight,
        module.features.6.16.0.0.0.3.weight,
        module.features.6.16.0.0.1.weight,
        module.features.6.17.0.0.0.0.weight,
        module.features.6.17.0.0.0.3.weight,
        module.features.6.17.0.0.1.weight,
        module.features.6.18.0.0.0.0.weight,
        module.features.6.18.0.0.0.3.weight,
        module.features.6.18.0.0.1.weight,
        module.features.6.19.0.0.0.0.weight,
        module.features.6.19.0.0.0.3.weight,
        module.features.6.19.0.0.1.weight,
        module.features.6.20.0.0.0.0.weight,
        module.features.6.20.0.0.0.3.weight,
        module.features.6.20.0.0.1.weight,
        module.features.6.21.0.0.0.0.weight,
        module.features.6.21.0.0.0.3.weight,
        module.features.6.21.0.0.1.weight,
        module.features.6.22.0.0.0.0.weight,
        module.features.6.22.0.0.0.3.weight,
        module.features.6.22.0.0.1.weight,
        module.features.7.0.0.0.0.0.weight,
        module.features.7.0.0.0.0.3.weight,
        module.features.7.0.0.0.1.weight,
        module.features.7.0.0.1.0.weight,
        module.features.7.1.0.0.0.0.weight,
        module.features.7.1.0.0.0.3.weight,
        module.features.7.1.0.0.1.weight,
        module.features.7.2.0.0.0.0.weight,
        module.features.7.2.0.0.0.3.weight,
        module.features.7.2.0.0.1.weight,
        module.last_linear.weight,
  ]

lr_schedulers:
  pruning_lr:
    class: ReduceLROnPlateau
    cooldown: 3
    patience: 3


policies:
  - pruner:
     instance_name : the_pruner
    starting_epoch: 1
    ending_epoch: 80
    frequency: 1

  - lr_scheduler:
      instance_name: pruning_lr
    starting_epoch: 70
    ending_epoch: 150
    frequency: 1
